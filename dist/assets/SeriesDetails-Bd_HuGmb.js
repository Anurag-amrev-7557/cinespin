import{e as k,r as n,j as e,m as a,A as C}from"./index-DVhI8atr.js";import{F as E,b as F,c as T,d as A,f as B}from"./index-CYHS-MDp.js";import{g as P,s as D}from"./cache-BlNW5Lp3.js";const R="92b98feaab02d1088661e456c19edb89",L="https://api.themoviedb.org/3",p="https://image.tmdb.org/t/p",O=t=>t?t.length>200?t.substring(0,150)+"...":t:"",M=()=>{var f,j,y,v,w;const{id:t}=k(),[i,h]=n.useState(null),[N,m]=n.useState(!0),[u,b]=n.useState(null),[S,g]=n.useState(!1),d=n.useRef(null),[x,$]=n.useState({x:0,y:0});n.useEffect(()=>{(async()=>{const l=`series-${t}`,c=P(l);if(c){h(c),m(!1);return}try{const o=await fetch(`${L}/tv/${t}?api_key=${R}&append_to_response=credits,videos,similar`);if(!o.ok)throw new Error("Failed to fetch series details");const _=await o.json();h(_),D(l,_)}catch(o){b(o.message)}finally{m(!1)}})()},[t]);const r={initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:25,mass:1}},exit:{opacity:0,y:-20}};return N?e.jsxs("div",{className:"series-details-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading series details..."})]}):u?e.jsx("div",{className:"series-details-error",children:e.jsxs("p",{children:["Error: ",u]})}):i?e.jsxs(a.div,{className:"series-details-container",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsx(a.div,{className:"series-details-overlay",style:{backgroundImage:`url(${p}/original${i.backdrop_path})`,backgroundSize:"cover",backgroundPosition:"center"},loading:"lazy",decoding:"async",...r,children:e.jsx("div",{className:"backdrop-overlay"})}),e.jsxs(a.div,{className:"series-content",...r,children:[e.jsxs(a.div,{className:"series-info",...r,children:[e.jsx(a.h1,{...r,children:i.name}),e.jsxs("div",{className:"series-meta",children:[e.jsxs(a.span,{...r,children:[e.jsx(E,{})," ",i.vote_average.toFixed(1)]}),e.jsxs(a.span,{...r,children:[e.jsx(F,{})," ",(f=i.release_date)==null?void 0:f.split("-")[0]]}),e.jsxs(a.span,{...r,children:[e.jsx(T,{})," ",i.runtime," min"]}),e.jsxs(a.span,{...r,children:[e.jsx(A,{})," ",i.original_language.toUpperCase()]}),e.jsxs(a.span,{...r,children:[e.jsx(B,{})," ",i.number_of_seasons," season",i.number_of_seasons>1?"s":""]})]}),e.jsx(a.div,{className:"series-genres",...r,children:i.genres.map(s=>e.jsx(a.span,{className:"genre-tag",...r,children:s.name},s.id))}),e.jsxs(a.div,{className:"series-overview",...r,children:[e.jsx("h2",{children:"Overview"}),e.jsx("p",{children:O(i.overview)}),((y=(j=i.videos)==null?void 0:j.results)==null?void 0:y.length)>0&&e.jsx(a.button,{onClick:()=>{if(d.current){const s=d.current.getBoundingClientRect(),l=window.scrollX||window.pageXOffset,c=window.scrollY||window.pageYOffset;$({x:s.left+s.width/2+l,y:s.top+s.height/2+c})}g(!0)},className:"trailer-button",ref:d,...r,children:"▶  Watch Trailer"})]}),((v=i.similar)==null?void 0:v.results)&&i.similar.results.length>0&&e.jsxs(a.div,{className:"similar-series",...r,children:[e.jsx("h2",{children:"Similar Series"}),e.jsx("div",{className:"similar-list",children:i.similar.results.filter(s=>s.poster_path&&s.vote_average&&(s.release_date||s.first_air_date)).map(s=>e.jsxs(a.a,{className:"similar-series",href:`/series/${s.id}`,...r,children:[e.jsx("picture",{children:e.jsx("img",{src:`${p}/original${s.poster_path}`,alt:s.title||s.name,loading:"lazy",decoding:"async"})}),e.jsx("span",{children:s.title||s.name})]},s.id))})]})]}),((w=i.credits)==null?void 0:w.cast)&&i.credits.cast.length>0&&e.jsxs(a.div,{className:"series-cast",...r,children:[e.jsx("h2",{children:"Cast"}),e.jsx("div",{className:"cast-list",children:i.credits.cast.map(s=>e.jsxs(a.a,{className:"cast-member",href:`/cast/${s.id}`,...r,children:[e.jsx("picture",{children:e.jsx("img",{src:s.profile_path?`${p}/original${s.profile_path}`:"/default.png",alt:s.name,loading:"lazy",decoding:"async"})}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsx(C,{children:S&&e.jsx(a.div,{className:"trailer-modal-overlay",onClick:()=>g(!1),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5,ease:"easeOut"},role:"dialog","aria-modal":"true",children:e.jsx(a.div,{className:"trailer-modal",onClick:s=>s.stopPropagation(),initial:{scale:.5,opacity:0,x:x.x-window.innerWidth/2,y:x.y-window.innerHeight/2},animate:{scale:1,opacity:1,x:0,y:0},exit:{scale:.7,opacity:0},transition:{scale:{type:"spring",stiffness:400,damping:20},opacity:{duration:.4},x:{type:"spring",stiffness:300,damping:30},y:{type:"spring",stiffness:300,damping:30}},children:e.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${i.videos.results[0].key}?autoplay=1&rel=0`,title:`${i.name} Trailer`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})})]}):e.jsx("div",{className:"series-details-error",children:e.jsx("p",{children:"Series not found"})})};export{M as default};
