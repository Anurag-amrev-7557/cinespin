import{r as t,j as e,u as T,m,F as U,b as I,c as H}from"./index-BwEYW-Gc.js";import{L as D,S as O,M as B,A as K}from"./index-D7unnDWH.js";import{F as V,a as z}from"./index-BN6NO_kq.js";import{R as W,a as Y,b as q}from"./index-CM4RPr90.js";import{g as J,s as Q}from"./cache-DJHUO1lX.js";const C="92b98feaab02d1088661e456c19edb89",f=[{id:28,name:"Action",icon:e.jsx(D,{})},{id:35,name:"Comedy",icon:e.jsx(H,{})},{id:18,name:"Drama",icon:e.jsx(z,{})},{id:27,name:"Horror",icon:e.jsx(W,{})},{id:14,name:"Fantasy",icon:e.jsx(O,{})},{id:878,name:"SciFi",icon:e.jsx(Y,{})},{id:10751,name:"Family",icon:e.jsx(B,{})},{id:10770,name:"Series",icon:e.jsx(K,{})},{id:16,name:"Animation",icon:e.jsx(q,{})}],X=()=>e.jsxs("div",{className:"skeleton-genre-card",children:[e.jsx("div",{className:"skeleton-genre-icon"}),e.jsx("div",{className:"skeleton-genre-title"})]}),re=()=>{const[i,E]=t.useState(f[0].id),[M,h]=t.useState([]),[o,x]=t.useState(1),[G,$]=t.useState(!0),[Z,y]=t.useState(()=>localStorage.getItem("region")||"Global"),[p,b]=t.useState(localStorage.getItem("region")||"Global"),[N,v]=t.useState(!0),[r,u]=t.useState(1),[_,j]=t.useState(1),k=35,L=T(),c=t.useCallback(async(a,s=1)=>{v(!0);const n=`series-${a}-${s}-${p}`,d=J(n);if(d){h(d.results||[]),x(d.total_pages||1),u(s);const l=Math.floor((s-1)/5)*5+1;j(l),v(!1);return}try{let l=`https://api.themoviedb.org/3/discover/tv?api_key=${C}&language=en-US&sort_by=popularity.desc&with_genres=${a}&page=${s}&include_adult=false&include_null_first_air_dates=false&with_type=Scripted`;const S={India:{region:"IN",language:"hi"},US:{region:"US",language:"en"},Global:null}[p];S?l+=`&region=${S.region}&with_original_language=${S.language}`:l+="&watch_region=US";const R=await fetch(l),g=await R.json();if(!R.ok||!g.results||g.results.length===0){const w=`https://api.themoviedb.org/3/trending/tv/week?api_key=${C}&language=en-US`,F=(await(await fetch(w)).json()).results||[],A=Math.ceil(F.length/k)||1;h(F.slice(0,k)),x(A),u(1),j(1)}else{h(g.results),x(g.total_pages||1),u(s);const w=Math.floor((s-1)/5)*5+1;j(w),Q(n,g)}}catch(l){console.error("Error fetching movies:",l),h([])}finally{v(!1)}},[p]),P=a=>{a!==i&&(E(a),u(1))};return t.useEffect(()=>{const a=s=>{if(s.key==="region"){const n=s.newValue||"Global";b(n),y(n)}};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)},[]),t.useEffect(()=>{const a=()=>{const s=localStorage.getItem("region")||"Global";b(s),y(s)};return window.addEventListener("regionChange",a),()=>window.removeEventListener("regionChange",a)},[c,i]),t.useEffect(()=>{c(i,1)},[i,p]),t.useEffect(()=>{$(!1)},[]),e.jsxs("div",{className:"movies-container",children:[e.jsx(m.div,{className:"genre-container",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut",delay:.3},children:!f.length||G?Array.from({length:f.length||9},(a,s)=>e.jsx("div",{className:"genre-slide",children:e.jsx(X,{})},s)):f.map(a=>e.jsx("div",{className:"genre-slide",children:e.jsxs("div",{className:`genre ${i===a.id?"active":""}`,onClick:()=>P(a.id),children:[e.jsx("div",{className:"genre-icon",children:a.icon}),a.name]})},a.id))}),e.jsxs("div",{className:"movies-list",children:[N?e.jsx("div",{className:"loading"}):e.jsx("div",{className:"movie-grid",children:M.map((a,s)=>{var n;return e.jsxs(m.div,{className:"movie-card",onClick:()=>L(`/movie/${a.id}`),initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:30,scale:.95},whileHover:{scale:1,y:-5},transition:{duration:.7,ease:[.4,0,.2,1]},children:[e.jsx("picture",{children:e.jsx("img",{src:a.poster_path?`https://image.tmdb.org/t/p/w500${a.poster_path}`:"/default.png",alt:a.title||a.name||"Untitled",className:"movie-poster",onError:d=>{d.target.src="/default.png"},loading:"lazy",decoding:"async"})}),e.jsx("span",{className:"movie-title",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a.name.split(" ").slice(0,3).join(" ")}),e.jsxs("div",{className:"movie-details",children:[e.jsxs("span",{children:[e.jsx(V,{className:"movie-star"})," ",a.vote_average.toFixed(1)]}),e.jsx("span",{className:"gap",children:" 〡 "}),e.jsx("span",{children:(n=a.first_air_date)==null?void 0:n.split("-")[0]}),a.runtime&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"gap",children:" 〡 "}),e.jsxs("span",{children:[a.runtime," min"]})]})]})]},a.id)})}),!N&&o===1&&e.jsx("div",{className:"limited-results-note",children:"Only a single page of results found."}),o>1&&e.jsxs("div",{className:"pagination-controls",children:[e.jsx(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{const a=r-1;a>=1&&c(i,a)},disabled:r===1,className:"pagination-nav",children:e.jsx(U,{})}),Array.from({length:Math.min(5,o-_+1)},(a,s)=>{const n=_+s;return e.jsx(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c(i,n),className:`pagination-page ${r===n?"active-page":""}`,children:n},n)}),e.jsx(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{const a=r+1;a<=o&&c(i,a)},disabled:r>=o,className:"pagination-nav",children:e.jsx(I,{})})]})]})]})};export{re as default};
