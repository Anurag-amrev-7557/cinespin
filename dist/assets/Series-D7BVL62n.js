import{r as t,j as e,u as L,m as _,c as A}from"./index-DVhI8atr.js";import{L as P,S as U,M as I,A as D}from"./index-equq3N9O.js";import{F as T,a as H}from"./index-CYHS-MDp.js";import{R as B,a as K,b as O}from"./index-B6XGXrZw.js";import{g as z,s as W}from"./cache-BlNW5Lp3.js";const b="92b98feaab02d1088661e456c19edb89",h=[{id:28,name:"Action",icon:e.jsx(P,{})},{id:35,name:"Comedy",icon:e.jsx(A,{})},{id:18,name:"Drama",icon:e.jsx(H,{})},{id:27,name:"Horror",icon:e.jsx(B,{})},{id:14,name:"Fantasy",icon:e.jsx(U,{})},{id:878,name:"SciFi",icon:e.jsx(K,{})},{id:10751,name:"Family",icon:e.jsx(I,{})},{id:10770,name:"Series",icon:e.jsx(D,{})},{id:16,name:"Animation",icon:e.jsx(O,{})}],Y=()=>e.jsxs("div",{className:"skeleton-genre-card",children:[e.jsx("div",{className:"skeleton-genre-icon"}),e.jsx("div",{className:"skeleton-genre-title"})]}),ae=()=>{const[n,w]=t.useState(h[0].id),[S,m]=t.useState([]),[p,u]=t.useState(1),[k,R]=t.useState(!0),[q,F]=t.useState(()=>localStorage.getItem("region")||"Global"),[r,C]=t.useState(localStorage.getItem("region")||"Global"),[E,x]=t.useState(!0),[c,f]=t.useState(1),[y,j]=t.useState(1),G=L(),l=t.useCallback(async(a,s=1)=>{x(!0);const i=`series-${a}-${s}-${r}`,d=z(i);if(d){m(d.results||[]),u(d.total_pages||1),f(s);const o=Math.floor((s-1)/5)*5+1;j(o),x(!1);return}try{let o=`https://api.themoviedb.org/3/discover/tv?api_key=${b}&language=en-US&sort_by=popularity.desc&with_genres=${a}&page=${s}&include_adult=false&include_null_first_air_dates=false&with_type=Scripted`;r==="India"?o+="&region=IN&with_original_language=hi":r==="Global"&&(o+="&watch_region=US");const N=await fetch(o),g=await N.json();if(!N.ok||!g.results||g.results.length===0){const v=`https://api.themoviedb.org/3/trending/tv/week?api_key=${b}&language=en-US`,$=await(await fetch(v)).json();m($.results||[]),u(1),f(1),j(1)}else{m(g.results),u(g.total_pages||1),f(s);const v=Math.floor((s-1)/5)*5+1;j(v),W(i,g)}}catch(o){console.error("Error fetching movies:",o),m([])}finally{x(!1)}},[r]),M=a=>{a!==n&&(w(a),l(a,1))};return t.useEffect(()=>{const a=()=>{const s=localStorage.getItem("region")||"Global";C(s),F(s)};return window.addEventListener("regionChange",a),()=>window.removeEventListener("regionChange",a)},[l,n]),t.useEffect(()=>{l(n,1)},[n,l]),t.useEffect(()=>{R(!1)},[]),t.useEffect(()=>{l(n,1)},[r]),e.jsxs("div",{className:"movies-container",children:[e.jsx(_.div,{className:"genre-container",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},children:!h.length||k?Array.from({length:h.length||9},(a,s)=>e.jsx("div",{className:"genre-slide",children:e.jsx(Y,{})},s)):h.map(a=>e.jsx("div",{className:"genre-slide",children:e.jsxs("div",{className:`genre ${S.length>0?"active":""}`,onClick:()=>M(a.id),children:[e.jsx("div",{className:"genre-icon",children:a.icon}),a.name]})},a.id))}),e.jsxs("div",{className:"movies-list",children:[E?e.jsx("div",{className:"loading",children:"Loading..."}):e.jsx("div",{className:"movie-grid",children:S.map((a,s)=>{var i;return e.jsxs(_.div,{className:"movie-card",onClick:()=>G(`/movie/${a.id}`),initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:30,scale:.95},whileHover:{scale:1,y:-5},transition:{duration:.25,ease:[.4,0,.2,1]},children:[e.jsx("picture",{children:e.jsx("img",{src:a.poster_path?`https://image.tmdb.org/t/p/w500${a.poster_path}`:"/default.png",alt:a.title||a.name||"Untitled",className:"movie-poster",onError:d=>{d.target.src="/default.png"},loading:"lazy",decoding:"async"})}),e.jsx("span",{className:"movie-title",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a.name.split(" ").slice(0,3).join(" ")}),e.jsxs("div",{className:"movie-details",children:[e.jsxs("span",{children:[e.jsx(T,{className:"movie-star"})," ",a.vote_average.toFixed(1)]}),e.jsx("span",{className:"gap",children:" 〡 "}),e.jsx("span",{children:(i=a.first_air_date)==null?void 0:i.split("-")[0]}),a.runtime&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"gap",children:" 〡 "}),e.jsxs("span",{children:[a.runtime," min"]})]})]})]},a.id)})}),p>1&&e.jsxs("div",{className:"pagination-controls",children:[e.jsx("button",{onClick:()=>l(n,c-1),disabled:c===1,children:"Prev"}),Array.from({length:Math.min(5,p-y+1)},(a,s)=>{const i=y+s;return e.jsx("button",{onClick:()=>l(n,i),className:c===i?"active-page":"",children:i},i)}),e.jsx("button",{onClick:()=>l(n,c+1),disabled:c>=p,children:"Next"})]})]})]})};export{ae as default};
